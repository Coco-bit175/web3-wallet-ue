<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Phantom Wallet Connect</title>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  </head>
  <body>
    <h2 id="wallet">Wallet: Not connected</h2>
    <h2 id="balance">Balance: -</h2>
    <button id="connect">Connect Phantom</button>

    <script>
      const connectPhantom = async () => {
        if (window.solana && window.solana.isPhantom) {
          try {
            const resp = await window.solana.connect();
            const walletAddress = resp.publicKey.toString();

            const connection = new solanaWeb3.Connection(
              solanaWeb3.clusterApiUrl("mainnet-beta")
            );

            const balanceLamports = await connection.getBalance(resp.publicKey);
            const balanceSOL = balanceLamports / solanaWeb3.LAMPORTS_PER_SOL;

            document.getElementById("wallet").innerText = `Wallet: ${walletAddress}`;
            document.getElementById("balance").innerText = `Balance: ${balanceSOL} SOL`;

            // ðŸ”¥ Send data to your backend
            fetch("http://localhost:3000/api/wallet-connect", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                address: walletAddress,
                balance: balanceSOL,
              }),
            });

          } catch (err) {
            console.error("Phantom Connect Error:", err);
          }
        } else {
          alert("Please install Phantom Wallet extension");
        }
      };

      window.onload = () => {
        document.getElementById("connect").addEventListener("click", connectPhantom);
      };
    </script>
  </body>
</html>
